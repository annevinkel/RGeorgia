<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Gerko Vink, Anne Vinkel Hansen og Peter Stoltze" />


<title>Practical B</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Practical B</h1>
<h4 class="author">Gerko Vink, Anne Vinkel Hansen og Peter Stoltze</h4>
<h4 class="date">Statistical Programming with R</h4>

</div>


<hr />
<div id="exercises" class="section level4">
<h4>Exercises</h4>
<p>Begin this practical by setting the maximum line length in <code>R-Studio</code> to 80 characters. Go to <code>RStudio</code>’s <code>Preferences</code> (or <code>Global Options</code> under <code>Tools</code>) –&gt; <code>Code</code> –&gt; <code>Display</code>, and tick the <code>show margin</code> box. Make sure that the <code>margin column</code> is set to <code>80</code></p>
<p>This is also a good time to set Rstudio to not automatically restore .RData into workspace at startup and not to save workspace to .RData on exit. (<code>Tools</code> –&gt; <code>Global Options</code> –&gt; <code>General</code>)</p>
<hr />
<ol style="list-style-type: decimal">
<li><strong>Load package <code>mice</code>. </strong> Loading packages can be done through functions <code>library()</code> and <code>require()</code>.</li>
</ol>
<pre class="r"><code>library(mice)</code></pre>
<pre><code>## 
## Attaching package: &#39;mice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     cbind, rbind</code></pre>
<p>If you use <code>require()</code> within a function, and the required package is not available, <code>require()</code> will yield a warning and the remainder of the function is still executed, whereas <code>library()</code> will yield an error and terminate all executions. The use of <code>library()</code> when not doing too complicated things is preferred - <code>require()</code> would result in more computational overhead because it calls <code>library()</code> itself.</p>
<hr />
<ol start="2" style="list-style-type: decimal">
<li><strong>Most packages have datasets included. Open the <code>mammalsleep</code> dataset from package <code>mice</code> by typing <code>mammalsleep</code> in the console, and subsequently by using the function <code>View()</code>. </strong></li>
</ol>
<p>Using <code>View()</code> is preferred for inspecting datasets that are large. <code>View()</code> opens the dataset in a spreadsheet-like window (conform MS Excel, or SPSS). If you <code>View()</code> your own datasets, you can even edit the datasets’ contents.</p>
<hr />
<ol start="3" style="list-style-type: decimal">
<li><strong>Write the mammalsleep dataset from package <code>mice</code> to the work directory as a tab-delimited text file with <code>.</code> as a decimal seperator. Name the file <code>mammalsleep.txt</code></strong></li>
</ol>
<pre class="r"><code>library(mice)
write.table(mammalsleep, &quot;mammalsleep.txt&quot;, sep = &quot;\t&quot;, dec = &quot;.&quot;, row.names = FALSE)</code></pre>
<p>The command <code>sep = "\t"</code> indicates that the file is tabulated and the command <code>dec = "."</code> indicates that a point is used as the decimal seperator (instead of a comma). <code>row.names = FALSE</code> tells <code>R</code> that row names are not to be included in exported file.</p>
<hr />
<ol start="4" style="list-style-type: decimal">
<li><strong>Import the <code>mammalsleep.txt</code> file. </strong></li>
</ol>
<pre class="r"><code>sleepdata &lt;- read.table(&quot;mammalsleep.txt&quot;, sep = &quot;\t&quot;, dec = &quot;.&quot;, header = TRUE)</code></pre>
<p>The command <code>sep = "\t"</code> indicates that the file is tabulated and the command <code>dec = "."</code> indicates that a point is used as the decimal seperator (instead of a comma). <code>header = TRUE</code> tells <code>R</code> that variable names are included in the header.</p>
<p>All files that are presented in the work directory of the current <code>R</code> project, can essentially be imported into the workspace (the space that contains all environments) directly. All other locations require you to specify the specific path from the root of your machine. To find out what the current work directory is, you can type <code>getwd()</code> and to change the work directory you can use <code>setwd()</code>. The beauty of using projects in RStudio is that you would never have to change the work directory, as the work directory is automatically set, relative to your projects’ <code>R</code>-scripts.</p>
<p>There are many packages that facilitate importing datasets from other statistical software packages, such as SPSS (e.g. function <code>read_spss</code> from package <code>haven</code>), Mplus (package <code>MplusAutomation</code>), Stata (<code>read.dta()</code> in <code>foreign</code>), SAS (<code>sasxport.get()</code> from package <code>Hmisc</code>) and from spreadsheet software, such as MS Excel (function <code>read.xlsx()</code> from package <code>xlsx</code>). For a short guideline to import multiple formats into <code>R</code>, see e.g. <a href="http://www.statmethods.net/input/importingdata.html" class="uri">http://www.statmethods.net/input/importingdata.html</a>.</p>
<hr />
<ol start="5" style="list-style-type: decimal">
<li><strong>The dataset we’ve just imported contains the sleepdata by Allison &amp; Cicchetti (1976). Inspect the sleepdata and make yourself familiar with it. Create a new variable named “bw2” containing body weight in grams </strong></li>
</ol>
<p>If you would like to know more about this dataset, you can open the help for the <code>mammalsleep</code> dataset in package <code>mice</code> through <code>?mammalsleep</code>. Don’t forget to load package <code>mice</code> first.</p>
<p>Inspecting the sleepdata could be done by</p>
<pre class="r"><code>str(sleepdata) #the data structure</code></pre>
<pre><code>## &#39;data.frame&#39;:    62 obs. of  11 variables:
##  $ species: chr  &quot;African elephant&quot; &quot;African giant pouched rat&quot; &quot;Arctic Fox&quot; &quot;Arctic ground squirrel&quot; ...
##  $ bw     : num  6654 1 3.38 0.92 2547 ...
##  $ brw    : num  5712 6.6 44.5 5.7 4603 ...
##  $ sws    : num  NA 6.3 NA NA 2.1 9.1 15.8 5.2 10.9 8.3 ...
##  $ ps     : num  NA 2 NA NA 1.8 0.7 3.9 1 3.6 1.4 ...
##  $ ts     : num  3.3 8.3 12.5 16.5 3.9 9.8 19.7 6.2 14.5 9.7 ...
##  $ mls    : num  38.6 4.5 14 NA 69 27 19 30.4 28 50 ...
##  $ gt     : num  645 42 60 25 624 180 35 392 63 230 ...
##  $ pi     : int  3 3 1 5 3 4 1 4 1 1 ...
##  $ sei    : int  5 1 1 2 5 4 1 5 2 1 ...
##  $ odi    : int  3 3 1 3 4 4 1 4 1 1 ...</code></pre>
<pre class="r"><code>summary(sleepdata) #distributional summaries</code></pre>
<pre><code>##    species                bw                brw               sws        
##  Length:62          Min.   :   0.005   Min.   :   0.14   Min.   : 2.100  
##  Class :character   1st Qu.:   0.600   1st Qu.:   4.25   1st Qu.: 6.250  
##  Mode  :character   Median :   3.342   Median :  17.25   Median : 8.350  
##                     Mean   : 198.790   Mean   : 283.13   Mean   : 8.673  
##                     3rd Qu.:  48.202   3rd Qu.: 166.00   3rd Qu.:11.000  
##                     Max.   :6654.000   Max.   :5712.00   Max.   :17.900  
##                                                          NA&#39;s   :14      
##        ps              ts             mls                gt        
##  Min.   :0.000   Min.   : 2.60   Min.   :  2.000   Min.   : 12.00  
##  1st Qu.:0.900   1st Qu.: 8.05   1st Qu.:  6.625   1st Qu.: 35.75  
##  Median :1.800   Median :10.45   Median : 15.100   Median : 79.00  
##  Mean   :1.972   Mean   :10.53   Mean   : 19.878   Mean   :142.35  
##  3rd Qu.:2.550   3rd Qu.:13.20   3rd Qu.: 27.750   3rd Qu.:207.50  
##  Max.   :6.600   Max.   :19.90   Max.   :100.000   Max.   :645.00  
##  NA&#39;s   :12      NA&#39;s   :4       NA&#39;s   :4         NA&#39;s   :4       
##        pi             sei             odi       
##  Min.   :1.000   Min.   :1.000   Min.   :1.000  
##  1st Qu.:2.000   1st Qu.:1.000   1st Qu.:1.000  
##  Median :3.000   Median :2.000   Median :2.000  
##  Mean   :2.871   Mean   :2.419   Mean   :2.613  
##  3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:4.000  
##  Max.   :5.000   Max.   :5.000   Max.   :5.000  
## </code></pre>
<pre class="r"><code>round(cor(sleepdata[, -1], use = &quot;pairwise.complete.obs&quot;), 2) #bivariate correlations, variable 1 excluded. </code></pre>
<pre><code>##        bw   brw   sws    ps    ts   mls    gt    pi   sei   odi
## bw   1.00  0.93 -0.38 -0.11 -0.31  0.30  0.65  0.06  0.34  0.13
## brw  0.93  1.00 -0.37 -0.11 -0.36  0.51  0.75  0.03  0.37  0.15
## sws -0.38 -0.37  1.00  0.51  0.96 -0.38 -0.59 -0.32 -0.54 -0.48
## ps  -0.11 -0.11  0.51  1.00  0.73 -0.30 -0.45 -0.45 -0.54 -0.58
## ts  -0.31 -0.36  0.96  0.73  1.00 -0.41 -0.63 -0.40 -0.64 -0.59
## mls  0.30  0.51 -0.38 -0.30 -0.41  1.00  0.61 -0.10  0.36  0.06
## gt   0.65  0.75 -0.59 -0.45 -0.63  0.61  1.00  0.20  0.64  0.38
## pi   0.06  0.03 -0.32 -0.45 -0.40 -0.10  0.20  1.00  0.62  0.92
## sei  0.34  0.37 -0.54 -0.54 -0.64  0.36  0.64  0.62  1.00  0.79
## odi  0.13  0.15 -0.48 -0.58 -0.59  0.06  0.38  0.92  0.79  1.00</code></pre>
<pre class="r"><code>head(mammalsleep) #first six rows</code></pre>
<pre><code>##                     species       bw    brw sws  ps   ts  mls  gt pi sei odi
## 1          African elephant 6654.000 5712.0  NA  NA  3.3 38.6 645  3   5   3
## 2 African giant pouched rat    1.000    6.6 6.3 2.0  8.3  4.5  42  3   1   3
## 3                Arctic Fox    3.385   44.5  NA  NA 12.5 14.0  60  1   1   1
## 4    Arctic ground squirrel    0.920    5.7  NA  NA 16.5   NA  25  5   2   3
## 5            Asian elephant 2547.000 4603.0 2.1 1.8  3.9 69.0 624  3   5   4
## 6                    Baboon   10.550  179.5 9.1 0.7  9.8 27.0 180  4   4   4</code></pre>
<pre class="r"><code>tail(mammalsleep) #last six rows</code></pre>
<pre><code>##                  species    bw  brw  sws  ps   ts  mls  gt pi sei odi
## 57                Tenrec 0.900  2.6 11.0 2.3 13.3  4.5  60  2   1   2
## 58            Tree hyrax 2.000 12.3  4.9 0.5  5.4  7.5 200  3   1   3
## 59            Tree shrew 0.104  2.5 13.2 2.6 15.8  2.3  46  3   2   2
## 60                Vervet 4.190 58.0  9.7 0.6 10.3 24.0 210  4   3   4
## 61         Water opossum 3.500  3.9 12.8 6.6 19.4  3.0  14  2   1   1
## 62 Yellow-bellied marmot 4.050 17.0   NA  NA   NA 13.0  38  3   1   1</code></pre>
<pre class="r"><code>?mammalsleep # the help</code></pre>
<pre><code>## starting httpd help server ... done</code></pre>
<p>Note that the sleepdata dataset is automatically recognized as a dataframe. After all, there is one factor (categorical variable) containing the animal names.</p>
<p>The functions <code>head()</code> and <code>tail()</code> are very useful functions. As is function <code>str</code> as it gives you a quick overview of the measurement levels in <code>mammalsleep</code>.</p>
<p>Since <code>mammalsleep</code> is an <code>R</code>-dataset, there should be a help file. Taking a look at <code>?mammalsleep</code> may yield valuable insight about the measurements and origin of the variables.</p>
<p>One thing that may have caught your attention is the relation between <code>ts</code>, <code>ps</code> and <code>sws</code>. This is a deterministic relation where total sleep (<code>ts</code>) is the sum of paradoxical sleep (<code>ps</code>) and short-wave sleep (<code>sws</code>). In the event that you would model the data, you need to take such relations into account.</p>
<p>To make a new variable containing body weight in grams, we transform the <code>bw</code> variable</p>
<pre class="r"><code>sleepdata$bw2 &lt;- sleepdata$bw*1000</code></pre>
<hr />
<ol start="6" style="list-style-type: decimal">
<li><strong>Save the current workspace. Name the workspace <code>Practical_B.RData</code>. Also, save the sleepdata file as a separate workspace called <code>Sleepdata.RData</code>. </strong></li>
</ol>
<p>Now that we have imported our data, it may be wise to save the current workspace, i.e. the current state of affairs. Saving the workspace will leave everything as is, so that we can continue from this exact state at a later time, by simply opening the workspace file. To save everything in the current workspace, type</p>
<pre class="r"><code>save.image(&quot;Practical_B.RData&quot;)</code></pre>
<p>To save just the dataset <code>sleepdata</code>, and nothing else, type</p>
<pre class="r"><code>save(sleepdata, file = &quot;Sleepdata.RData&quot;)</code></pre>
<p>With the save functions, any object in the workspace can be saved.</p>
<hr />
<ol start="7" style="list-style-type: decimal">
<li><strong>Some animals were not used in the calculations by Allison and Cicchetti. Exclude the following animals from the sleepdata dataset: Echidna, Lesser short-tailed shrew and Musk shrew. Save the dataset as sleepdata2.</strong> Tip: use the square brackets to indicate [rows, columns].</li>
</ol>
<p>There are two ways to exclude the three animals from the dataset. The first approach uses the names:</p>
<pre class="r"><code>exclude &lt;- c(&quot;Echidna&quot;, &quot;Lesser short-tailed shrew&quot;, &quot;Musk shrew&quot;)
which &lt;- sleepdata$species %in% exclude #Indicate the species that match the names in exclude
which</code></pre>
<pre><code>##  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [13] FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE
## [37] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [61] FALSE FALSE</code></pre>
<pre class="r"><code>sleepdata2 &lt;- sleepdata[!which, ]</code></pre>
<p>while the second approach uses the row numbers directly (you would need to inquire about, or calculate the rownumbers)</p>
<pre class="r"><code>sleepdata2 &lt;- sleepdata[-c(16, 32, 38), ]</code></pre>
<p>Note that the numbered option requires less code, but the named option has a much lower probability for error. As the dataset might change, or might get sorted differently, the second option may not be valid anymore.</p>
<ol start="8" style="list-style-type: decimal">
<li><strong>Let’s try reading in some data with special characters. On the course homepage, you will find the file <code>cabinet.txt</code>. Try reading this into R, and try getting the special characters right</strong></li>
</ol>
<pre class="r"><code>cabinet &lt;- read.delim(&quot;cabinet.txt&quot;, encoding=&quot;UTF-8&quot;, stringsAsFactors = F)

head(cabinet)</code></pre>
<pre><code>##                                               Portfolio          Minister
## 1                                        Prime Minister Mette Frederiksen
## 2                          Minister for Foreign Affairs       Jeppe Kofod
## 3                                  Minister for Finance    Nicolai Wammen
## 4           Minister of Social Affairs and the Interior       Astrid Krag
## 5                                  Minister for Justice     Nick Hækkerup
## 6 Minister for Industry, Business and Financial Affairs    Simon Kollerup
##    Took.office Left.office            Party
## 1 27 June 2019   Incumbent Social Democrats
## 2 27 June 2019   Incumbent Social Democrats
## 3 27 June 2019   Incumbent Social Democrats
## 4 27 June 2019   Incumbent Social Democrats
## 5 27 June 2019   Incumbent Social Democrats
## 6 27 June 2019   Incumbent Social Democrats</code></pre>
<p>The UTF-8 encoding should take care of the special characters. But don’t we want the dates to be dates rather than characters?</p>
<pre class="r"><code># The date function assumes that I am giving dates in Danish. These variables are in English, so I&#39;m resetting 
Sys.setlocale(category = &quot;LC_TIME&quot;, locale = &quot;English&quot;)</code></pre>
<pre><code>## [1] &quot;English_United States.1252&quot;</code></pre>
<pre class="r"><code>cabinet$Took.office &lt;- as.Date(cabinet$Took.office, format = &quot;%d %B %Y&quot;)</code></pre>
<p>If you’re going to work with special characters in your code files (say, writing comments in Danish) you will want to set the RStudio encoding to UTF-8 as welll, under <code>Tools</code> –&gt; <code>Global Options</code> –&gt; <code>Code</code> –&gt; <code>Saving</code></p>
<hr />
<p>End of exercise</p>
<hr />
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
